import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.ObjectInput;
import java.io.ObjectInputStream;
import org.apache.commons.collections.map.LazyMap;
import org.apache.commons.collections.*;
import org.apache.commons.collections.Transformer;

public class javaDeserializationVulnerability {
    public static void main(String[] args){
        System.out.println("\nWelcome World!");
    
        try{
            // Open the serialized file byte stream
            System.out.println("\nStarting to read file...");
            FileInputStream vulnSerialFile = new FileInputStream("serialized_output");

            // Open object deserializer
            try{
                System.out.println("\nStarting to read objects...");
                ObjectInputStream objDeserializer = new ObjectInputStream(vulnSerialFile);
                // Try to read objects
                try{
                    Object myDeserializedObject = (Object) objDeserializer.readObject();
                    System.out.println("\nDeserialization Completed.");
                }
                catch(ClassNotFoundException e){
                    System.out.print("Error Occured. Class not found!\n");
                    System.out.println(e.getMessage());
                }
                

                objDeserializer.close();
                vulnSerialFile.close();

            }
            catch(IOException e){
                System.out.print("Error Occured. IOException\n");
                System.out.println(e.getMessage());
            }
            

        }
        catch(FileNotFoundException e){
            System.out.print("Error Occured. FileNotFoundException\n");
            System.out.println(e.getMessage());

        }
        
    }


}

